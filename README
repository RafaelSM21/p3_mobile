Este Ã© um Ã³timo projeto\! Transformei suas notas em um arquivo **README.md** com formataÃ§Ã£o, emojis e foco na clareza para facilitar o entendimento e a execuÃ§Ã£o.

-----

# ğŸš€ API Node.js Completa com AutenticaÃ§Ã£o JWT e Strategy Pattern

Este projeto Ã© uma **API RESTful robusta** desenvolvida com **Node.js, Express, TypeScript e PostgreSQL**, focada em seguranÃ§a e arquitetura limpa. Ele utiliza o padrÃ£o **Strategy Pattern** para flexibilizar a autenticaÃ§Ã£o e inclui um frontend simples para testes rÃ¡pidos de ponta a ponta.

-----

## âœ¨ Recursos Principais

| Categoria | Recurso | DescriÃ§Ã£o |
| :--- | :--- | :--- |
| **Backend** | **Node.js + Express** | API REST rÃ¡pida e eficiente em TypeScript. |
| **Banco de Dados** | **PostgreSQL + Prisma ORM** | Gerenciamento de dados seguro e tipado. |
| **SeguranÃ§a** | **JWT (JSON Web Tokens)** | AutenticaÃ§Ã£o stateless com tokens. |
| **Arquitetura** | **Strategy Pattern** | EstratÃ©gia de autenticaÃ§Ã£o flexÃ­vel (PadrÃ£o/Master Key). |
| **Controle** | **PermissÃµes (ADMIN/USER)** | Middleware de autenticaÃ§Ã£o e autorizaÃ§Ã£o por funÃ§Ã£o. |
| **Frontend** | **HTML/CSS/JS** | Interface simples e responsiva para testar fluxos. |
| **Testes** | **TDD com Jest** | Testes unitÃ¡rios para a camada de autenticaÃ§Ã£o. |

-----

## ğŸ“‚ Estrutura do Projeto

A arquitetura do projeto Ã© dividida em mÃ³dulos claros para separar responsabilidades:

```
projeto/
â”‚
â”œâ”€â”€ src/
â”‚Â  Â â”œâ”€â”€ routes/         # DefiniÃ§Ã£o dos endpoints da API
â”‚Â  Â â”œâ”€â”€ services/       # LÃ³gica de negÃ³cio (ex: AuthService)
â”‚Â  Â â”œâ”€â”€ middlewares/    # Middleware de JWT e PermissÃµes
â”‚Â  Â â”œâ”€â”€ strategies/     # ImplementaÃ§Ãµes do Strategy Pattern
â”‚Â  Â â”œâ”€â”€ db/             # ConfiguraÃ§Ã£o Singleton do Prisma
â”‚Â  Â â”œâ”€â”€ app.ts          # ConfiguraÃ§Ã£o do Express
â”‚Â  Â â””â”€â”€ server.ts       # InicializaÃ§Ã£o do servidor
â”‚
â”œâ”€â”€ frontend/           # Interface de teste
â”œâ”€â”€ prisma/             # Schema e MigraÃ§Ãµes
â””â”€â”€ __tests__/          # Arquivos de Teste (Jest)
```

-----

## ğŸ”’ AutenticaÃ§Ã£o e SeguranÃ§a

O projeto utiliza **JWT** e o **Strategy Pattern** para definir o mÃ©todo de autenticaÃ§Ã£o, suportando fluxos diferentes atravÃ©s da mesma API.

### ğŸ”‘ EstratÃ©gias de AutenticaÃ§Ã£o

1.  **EmailPasswordStrategy (PadrÃ£o):** AutenticaÃ§Ã£o padrÃ£o de usuÃ¡rio com **email e senha**.
2.  **MasterKeyStrategy:** AutenticaÃ§Ã£o especial usando uma **Chave Mestra** (`MASTER_KEY`) para login administrativo, ideal para criaÃ§Ã£o inicial de usuÃ¡rios `ADMIN`.

### VariÃ¡veis de Ambiente (`.env`)

Configure as seguintes variÃ¡veis na raiz do projeto:

```env
DATABASE_URL="postgresql://[usuÃ¡rio]:[senha]@localhost:5432/[nome_do_banco]"
JWT_SECRET="seuSegredoParaAssinaturaDeTokens"
JWT_EXPIRES_IN="8h"
MASTER_KEY="SUA_CHAVE_MASTER_SECRETA"
```

### PermissÃµes

O sistema utiliza um campo `role` no banco para gerenciar acessos:

  * **USER:** UsuÃ¡rios comuns.
  * **ADMIN:** Administradores. Possuem privilÃ©gios exclusivos, como a **exclusÃ£o de usuÃ¡rios**.

-----

## ğŸ–¥ API Endpoints

| MÃ©todo | Rota | DescriÃ§Ã£o | Requer Token? | Somente ADMIN? |
| :--- | :--- | :--- | :---: | :---: |
| **POST** | `/auth/register` | CriaÃ§Ã£o de novo usuÃ¡rio. | âŒ | âŒ |
| **POST** | `/auth/login` | Login (padrÃ£o ou MasterKey). | âŒ | âŒ |
| **GET** | `/users` | Lista todos os usuÃ¡rios. | âœ” | âŒ |
| **GET** | `/users/:id` | Busca um usuÃ¡rio por ID. | âœ” | âŒ |
| **DELETE** | `/users/:id` | Deleta um usuÃ¡rio por ID. | âœ” | âœ” |

-----

## ğŸ’¾ Banco de Dados (Prisma + PostgreSQL)

O modelo de dados Ã© simples e centralizado no `schema.prisma`:

```prisma
model User {
  id        Int     @id @default(autoincrement())
  name      String
  email     String  @unique
  password  String
  role      String  @default("USER")

  @@map("users")
}
```

-----

## â–¶ï¸ Como Rodar o Projeto

### 1\. PrÃ©-requisitos

Certifique-se de ter **Node.js** e uma instÃ¢ncia de **PostgreSQL** rodando.

### 2\. Instalar dependÃªncias

```bash
npm install
```

### 3\. Configurar e Migrar o Banco de Dados

Crie o arquivo `.env` (conforme a seÃ§Ã£o de seguranÃ§a acima) e execute as migraÃ§Ãµes:

```bash
npx prisma migrate dev
npx prisma generate
```

### 4\. Rodar a API (Modo Desenvolvimento)

O servidor de desenvolvimento utiliza `ts-node` e sobe na porta **3000**:

```bash
npm run dev
```

A API estarÃ¡ acessÃ­vel em: `http://localhost:3000`

### 5\. Rodar o Frontend (Para Teste)

O frontend Ã© uma aplicaÃ§Ã£o simples em `frontend/index.html` que demonstra o uso dos endpoints:

```bash
npm run frontend
```

O site abrirÃ¡ em: `http://localhost:3000` (ou porta adjacente, se ocupada).

-----

## ğŸ§ª Testes UnitÃ¡rios (TDD com Jest)

Os testes sÃ£o focados na camada de autenticaÃ§Ã£o (`__tests__/auth.test.ts`) para garantir a integridade dos fluxos de login e registro.

Para rodar todos os testes:

```bash
npm test
```
